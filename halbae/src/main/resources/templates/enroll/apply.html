<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/layout/header::headFrag('Apply Form')}"></head>

<link rel="stylesheet" th:href="@{/css/applyForm.css(ver=1.0)}">


<script th:inline="javascript">

	$(function(){
		printStar();
		fnList();
	})

	/* ν‰μ  */
	function printStar() {
		let grade = /*[[${classList.classGrade}]]*/ null;
		for(let i=0; i< grade; i++) {
			$('#star').append('<i class="fa-solid fa-star" style="color: #f4575f;"></i>');
		}
	}
	
	/* λ§κ° ν΄λμ¤ ν΄λ¦­ μ‹ */
	function fnList() {
		$('.radioCheck').on('click', function(event){
			console.log(event);
			let state = $(this).parent().find('.stateCheck').val();
			if(state === "0") {
				alert('ν•΄λ‹Ή ν΄λμ¤λ” λ§κ°λμ—μµλ‹λ‹¤ π¥');
				$(this).parent().find('.radioCheck').prop('checked', false);
				return;
			}
		})
	}

	/* μΈμ› + - λ°•μ¤ */
	function fnNum(element) {
		let enrollPerson = parseInt($('#enrollPerson').val());
		if (element.id == 'btn_minus' && enrollPerson > 0 ) {
			$('#enrollPerson').val(enrollPerson - 1);
		} else {
			$('#enrollPerson').val(parseInt($('#enrollPerson').val()) + 1);
		}
	}
	
	/* νμ› ID ν†µν•΄ μ—°λ½μ² ν‘μ‹ */
	$(document).ready(function() {
		$.ajax({
			url: 'enroll/user.do',
            type: 'get',
            success: function(resData) {
            	$('#userTel').val(resData);
            	},
            error: function(xhr, status, error) {
                        console.log('μ¤λ¥ λ°μƒ');
                        }
                });
            });

</script>

<body>

<div th:replace="~{/layout/header::gnbFrag}"></div>
	<div id="main_wrap">
  		<div id="enroll_title">κ°•μμ‹ μ²­</div>
  		<form method="post" action="/enroll/apply.do">
  			<!--/* νλΌλ―Έν„°1 : userId */-->
  			<input type="hidden" name="userNo" value="${session.userNo}">
  			<div id="main_box">
		  		<div id="main_L">
					<div th:object="${classList}" id="applyClass">
  					<!--/* νλΌλ―Έν„°2 : classNo */-->
  					<input type="hidden" name="classNo" th:value="*{classNo}">
						<img th:src="*{classMainPath}" width="250px" id="classImage">
						<div>
				  			<div th:text="*{classTitle}" id="classTitle"></div>
				  			<div id="classinfo">
				  				<div th:text="|*{classTime} μμ—…|" id="classTime"></div>
				  				<div th:text="*{classArea}" id="classArea"></div>
				  			</div>
			  				<span id="star"></span><span th:text="*{classGrade}"></span>
						</div>
					</div>
					<div id="sch">ν„μ¬ μμ •λμ–΄ μλ” μμ—…μ΄μ—μ”.</div>
					<div id="schList">
					<ul class="scheduleArray">
					<th:block th:each="sch,vs:${scheduleList}">
							<li class="schduleList">
								<!--/* νλΌλ―Έν„°3 : schNo */--> 
								<input type="radio" th:id="|inp_radio${vs.index}|" name="schNo" th:value="${sch.schNo}" class=" ;/m ">
								<label th:for="|inp_radio${vs.index}|">
									<span th:text="${#dates.format(sch.schStart,'yyyyλ…„ Mμ›” dμΌ Hμ‹')}" class="schStart"></span>
									<span class="block">
										<span th:text="| (${sch.schNowNum}|"></span>
										<span th:text="| /${sch.schMaxNum}λ…) |" class="schNum"></span>
					 					<th:block th:if="${sch.schState == 0}">
					 						<input type="hidden" class="stateCheck" value="0">
											<span class="unavailable">λ§κ°</span>
										</th:block>
					 					<th:block th:if="${sch.schState == 1}">
					 						<input type="hidden" class="stateCheck" value="1">
											<span class="available">μ‹ μ²­κ°€λ¥</span>
										</th:block>
									</span>
								</label>
							</li>
					</th:block>
							<li class="scheduleArray">
								<!--/* νλΌλ―Έν„°3 : schNo (μ‘κ°€λ‹κ³Ό ν‘μ) */-->
								<input type="radio" id="inp_radio_etc" name="schNo" value="0">
								<label for="inp_radio_etc">
									<span>μ‘κ°€λ‹κ³Ό ν‘μ ν›„ κ²°μ •ν• κ²μ” :)</span>
								</label>
							</li>
						</ul>
					</div>
		  		</div>
		  		
		  		<div id="main_R" >
		  			<table id="tb_apply">
		  				<tbody>
		  					<tr id="tr_first">
		  						<td id="num_Title">μ‹ μ²­ μΈμ›</td>
		  						<td id="boxNum">
		  							<button type="button" id="btn_minus" onclick="fnNum(this)"></button>
		  							<!--/* νλΌλ―Έν„°4 : enrollPerson */--> 
					  				<input type="text" maxlength="${sch.schMaxNum}" value="1" name="enrollPerson" id="enrollPerson">
					  				<button type="button" id="btn_plus" onclick="fnNum(this)"></button>
		  						</td>
		  					</tr>
		  					<tr id="tr_second">
		  						<td id="phoneNumber">μ—°λ½μ²</td>
		  						<td id="boxTel"><input type="text" disabled="disabled" id="userTel" style="height: 30px;"></td>
		  					</tr>
		  					<tr id="tbtr">
		  						<td id="toTuter" colspan="2">νν„°μ—κ² μ „λ‹¬ν•κ³  μ‹¶μ–΄μ”!</td>
		  					</tr>
		  					<tr>
		  						<td colspan="2">
		  							<div id="toTuterBox">
		  								<!--/* νλΌλ―Έν„°5 : enrollRequest */--> 
		  								<textarea name="enrollRequest" rows="8" cols="40" placeholder="κ²½ν— μ λ¬΄ μ—¬λ¶€λ¥Ό μ•λ ¤μ£Όμ‹λ©΄ νν„°λ‹μ ν΄λμ¤ μ¤€λΉ„μ— ν° λ„μ›€μ΄ λ©λ‹λ‹¤ :) κ·Έ μ™Έ ν•κ³  μ‹¶μ€ λ§μ΄ μλ‹¤λ©΄ λ‚¨κ²¨μ£Όμ„Έμ”!"></textarea>
		  							</div>
		  						</td>
		  					</tr>
		  				</tbody>
		  			</table>
		  			<div>
		  				<button id="btn_next">λ‹¤μ</button>
		  			</div>
			</div>
  		</div> 			
  	</form>
	</div>
  
  γ„΄
</body>
</html>